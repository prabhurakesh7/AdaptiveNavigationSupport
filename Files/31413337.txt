mockito returning expected 
stub getkeyfromstream method matchers explicit explicit anyobject matter stub return fookey unit test wondering protected missing incorrectly statements tests em working em reason getkeyfromstream generally bytearrayinputstream match inputstream avail unit test 

problem unit test mock method actual class test invoke mock method return null declare mocked return invoked method mock external dependencies ways create test objects primer create object based class provided internal state null return invoked method define return values method invocations hand creates real object intercepts method invocations mock definitions defined methods mockito powermock provide ways defining mocked methods difference execute methods implementation wont important deal objects dont execute real code inside invoked method replace code return predefined mockito powermock provide define invoke execute code real object ignores mocked method return statements case mock method class test method implementation overwritten simply declare logic invoked method utilize return mock result protected method code works semantic simply declaring return modify modifying system test sut wont achieve real code executed mock sut object invoke method section return null mock object real method woulb called mentiond invoke real implementations mock method mocking methods actual class test puts burden good enterprise policy test private protected methods stick testing public api recommend possibility href http iosunittesting refactoring improve testability rel nofollow refactor code order improve testability primary intent refactoring href http programmers stackexchange questions refactoring purpose unit testing code smell improve design code 