unit testing akka actors junit 
write unit tests akka actors test actors messages flow observed strange behaviour tests fields system actors created annotated method code basically rarely test fails os exception processmessage method thrown illegalstateexception due business logic test pass yetsomemessage message received yetanotheractor fact illegatestateexception error thrown logged stack trace assume akka testactorref documentation blockquote special actorref exclusively unit testing single threaded environment overrides dispatcher callingthreaddispatcher sets receivetimeout acts normal actorref retrieve reference underlying actor test internal logic blockquote system single thread process messages received actor explain proper assertion test fails returning sending yetsomemessage proper code understand thread processing lead test faiulre 

testactorref basically synchronous testing general rule thumb dont testactorref thing callingthreaddispatcher steal callers thread execute actor solution mystery actor runs thread test exception ends test thread fortunately test case testactorref create actor ordinary work actor proper separate thread asynchronous test support href http doc akka io docs akka scala testing html asynchronous integration testing testkit rel nofollow http doc akka io docs akka scala testing html asynchronous integration testing testkit 