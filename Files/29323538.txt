concurrent queue consumption enigma 
speed image processing opencv parallel stream consume queue opencv time algorithm count left queue incoherent results processing stream parallel sequential computing results correct thought good thread safety asynchronicity apparently circumvent problem remarks ul li elements put queue consumption li li running real virtual core processor li ul h2 results sequential stream h2 blockquote frame collection start size production frame collection end size production consumption resulting list size algorithm run consumption algorithm ms blockquote h2 results parallel stream h2 blockquote frame collection start size production frame collection end size production consumption resulting list size algorithm run consumption algorithm ms blockquote h2 code h2 

things code caught eye creating stream track preferable calling return stream consisting em current contents em queue elements added queue processing wont work problem code generates stream edited clarity problem method defined blockquote retrieves removes head queue returns null queue empty blockquote stream run parallel streams threads drain queue faster elements produced inserted queue occurs queue empty point stream populated elements returned handed null pass output elements destination list alternative implementation method avoid injecting nulls stream implementation id advise investigate size bound producer outstrips consumers unbounded queue expand fill memory throws simple lambda youll figure interrupts return dummy element issue method imposes limit number elements passed em downstream em parallel streams multiple threads opportunistically pull number elements stream processing buffered operation limit reached time stream processing terminates elements pulled stream source buffered limit reached simply discarded elements pulled queue elements end result list sequential case numbers dont add dont thing buffered elements discarded limit reached additional elements produced processing live elements discarded parallel stream fed work approach required 