h2 database rows subquery array 
query works fine postgresql h2database important tables basically field query postgresql result result h2 implemented user defined functions problem implement dont passed query fails convince h2 return work 

dont rows array comma separated list needlessly complicated postgres begin simplified makes clear simply h2s equivalent postgres 