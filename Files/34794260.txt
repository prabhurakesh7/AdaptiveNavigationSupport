apache kafka client throw batch expired exception 
apache kafka client send long series records broker href https kafka apache org javadoc org apache kafka clients producer kafkaproducer html rel nofollow kafka producer class asynchronous href https kafka apache org javadoc org apache kafka clients producer kafkaproducer html send org apache kafka clients producer producerrecord rel nofollow send method returns immediately starts blocking call short time period thirty seconds client starts throwing exceptions href https kafka apache org javadoc org apache kafka common errors timeoutexception html rel nofollow timeoutexception message em batch expired em circumstances exception thrown 

exception queueing records faster rate call href https kafka apache org javadoc org apache kafka clients producer kafkaproducer html send org apache kafka clients producer producerrecord rel nofollow em send em method href https kafka apache org javadoc org apache kafka clients producer producerrecord html rel nofollow producerrecord stored internal buffer sending broker method returns immediately href https kafka apache org javadoc org apache kafka clients producer producerrecord html rel nofollow producerrecord buffered records grouped em batches em sending broker reduce transport overheard message increase throughput record added batch time limit sending batch ensure duration controlled producer configuration parameter href http kafka apache org documentation html producerconfigs rel nofollow em request timeout ms em defaults thirty seconds batch queued longer timeout limit exception thrown records batch removed send queue strong increasing timeout limit configuration parameter client queue batches longer expiring strong 