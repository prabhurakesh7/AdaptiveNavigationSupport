streams grouping items sorted streams efficiently 
implement terminal grouping operation memory overhead minimal distinct general case choice collect distinct items stream forward input stream sorted operation fly minimal memory achieve iterators iterator wrapper implementing grouping logic simpler implement streams api strong edit strong found abuse stream flatmap achieve prints technique kind memory efficient sequence grouping streams dont solution natural mapping filtering work breaking contract function supplied flatmap stateful 

solution doesn add mutable state function isn supposed resort works intended mutable containers work parallel splitting arbitrary stream positions implies possibility encounter threads general purpose action low level solution preferred added complexity inherits parallel support works prefetching values processing thread won accelerate em distinct em operation follow operations computation intense hr completion distinct operation arbitrary unsorted doesn rely boxing memory footprint works positive values expanding full bit range require concise case limiting storage bit range lower 