extract nearest point index linestring point 
lets linestring list points named trail detect point close trail linestring called interest points return closest index point trail linestring mention interest points included trail linestring evaluate index point trail giving interest point resulted interest point existing trail list img src http stack imgur haopg png alt enter image description strong edit strong convert problem plain numbers find easy input list input number easly conditon list lt number lt list check costs cost1 number list cost2 list number index cost1 lt cost2 return return strong important strong point objects comparable numbers drive blind spot 

speed important trace doesnt tend loop back detecting closest points differ detecting line segment pretty easy distance squared formula points takes place difference plain numbers real advantage plain distance distance squared calculate extra square root feel free find distances trace target point find distances pairs points find index smallest original list points alternatively find closest single point decide previous comparing distances inexact compute point closest approach point line segment points longer formula lot youll faster ignore big distances arent relevant common place grid trace make subtraces inside grid element point interest grid location searching trick inside grid search adjacent neighbors depending clip points inside grid 