0x1e error integrity error change desfire master key mistakes resolve 
h2 update1 question h2 recently working cards decide change defult em master key em em picc em authenticate master key byte 0x00 successfully defult choosed authenticate master key changed byte successfully random numbers random byte number random byte number create session key time random random session key byte random byte random create crc16 master key bellow method result d8 ec picc master key byte byte choosed byte master key create ew picc key crc padding deciphered calculate crc16 add key enciphered master key bellow method byte enciphered class des enciphering finally fill parameter byte array send instruction c4 utils class step sending apdu changing master key card recieved exception 0x1e error means integrity error crc mac match data padding bytes valid perform changing key correctly necessaryfor 

ol li desfire cards crc16 initial crc16 desfire expects troubles integrity error li li dec cbc encryption decryption array decryption mode encryption mode encrypting weird means li ol fact cbc mode decryption cbc mode encryption implement cbc mode block correct iv 