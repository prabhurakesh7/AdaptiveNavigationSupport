porting encryption routine 
attempting success port googles code generate secure token captcha href https github google recaptcha blob master appengine src main google recaptcha stokenutils https github google recaptcha blob master appengine src main google recaptcha stokenutils original utility values hardcoded back encrypted token crypto skills rusty arent direct analogs attempted merge isnt correct version produces incorrect 

strong code works expected strong mixed outputs version possibly version execute code jdk amp guava ye fysvnevuzjxth67 si e8fbuv4sxs7wexvdeojjbmhl1encvt65ggij8cifzbgp5uugkyjzcuq4rc964vzigjlrj 430lgycathlld9u execute code href https dotnetfiddle net 7xrgbv rel nofollow demo ye fysvnevuzjxth67 si e8fbuv4sxs7wexvdeojjbmhl1encvt65ggij8cifzbgp5uugkyjzcuq4rc964vzigjlrj 430lgycathlld9u1 version additional end padding character isnt means doesnt provide standards conform url base64 encoding shouldnt href http stackoverflow questions base64url rfc4648 amp url base64 encoding easily derived normal base64 encoding compare tables rfc4648 href http stackoverflow answer marc gravell blockquote blockquote hr output ye fysvnevuzjxth67 si e8fbuv4sxs7wexvdeojjbmhl1encvt65ggij8cifzbgp5uugkyjzcuq4rc964vzigjlrj 430lgycathlld9u href https gist github artjomb cdcd972d042a5b5690e5 rel nofollow decrypt token session id 4182e173 3a24 4c10 b76c b85a36be1173 ts ms 1445786965574 token code session id abf52ca5 9d87 b109 334abb7e637a ts ms 1445705791480 main remaining problem youre invalid json strings keys json wrapped means encrypted token valid version token code d9rop07fygbfza5vbgsvdpe8fbuv4sxs7wexvdeojjbmhl1encvt65ggij8cifzbsawbdgtdsozv4js aubu cgjlrj 430lgycathlld9u 