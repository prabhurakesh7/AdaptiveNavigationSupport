spark streaming foreachrdd error comparison method violates general contract 
testing spark streaming api application deployed amazon emr cluster spark sorting data saving files s3 code pipeline sort algorithm detailed application run cluster fails fast error blockquote error executor executor exception task stage tid lang illegalargumentexception comparison method violates general contract org apache spark util collection timsort sortstate mergelo timsort org apache spark util collection timsort sortstate mergeat timsort org apache spark util collection timsort sortstate mergecollapse timsort org apache spark util collection timsort sortstate access timsort org apache spark util collection timsort sort timsort org apache spark util collection sorter sort sorter scala org apache spark util collection partitionedpairbuffer partitioneddestructivesortediterator partitionedpairbuffer scala org apache spark util collection externalsorter partitionediterator externalsorter scala org apache spark util collection externalsorter iterator externalsorter scala org apache spark shuffle hash hashshufflereader read hashshufflereader scala org apache spark rdd shuffledrdd compute shuffledrdd scala org apache spark rdd rdd computeorreadcheckpoint rdd scala org apache spark rdd rdd iterator rdd scala org apache spark rdd mappartitionsrdd compute mappartitionsrdd scala org apache spark rdd rdd computeorreadcheckpoint rdd scala org apache spark cachemanager getorcompute cachemanager scala org apache spark rdd rdd iterator rdd scala org apache spark rdd mappartitionsrdd compute mappartitionsrdd scala org apache spark rdd rdd computeorreadcheckpoint rdd scala org apache spark rdd rdd iterator rdd scala org apache spark scheduler resulttask runtask resulttask scala org apache spark scheduler task run task scala org apache spark executor executor taskrunner run executor scala util concurrent threadpoolexecutor runworker threadpoolexecutor util concurrent threadpoolexecutor worker run threadpoolexecutor lang thread run thread blockquote error foreachrdd step searching fails 

class sorting bug compareto implementation javadoc href http docs oracle javase docs api lang comparable html rel nofollow comparable recommend implement compareto consistent equals fixing bug spark job works expected 