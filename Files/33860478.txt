dockerized hadoop datanode registering wrong ip address 
separate docker images hadoop namenodes datanodes create containers communicating user defined docker network datanode appears report ip address network gateway ip address whilst doesnt issues single datanode confusion reigns additional datanodes added register ip address namenode flips reporting single datanode live server namenode read wrong ip address client datanode socket connection running user defined docker network fix strong update issue docker side strong running containers executing netcat server container netcat client container correctly print connection port tcp accepted creating user defined network executing commands containers started incorrectly prints ip address gateway user defined network interface connection port tcp accepted strong hdfs docker details strong property datanodes file set hostname network created namenode started datanode started nodes connect fine queried connectivity reported live datanodes hostname hdfs datanode output running namenode thinks running datanode running hdfs namenode localhost localhost ip6 localhost ip6 loopback fe00 ip6 localnet ff00 ip6 mcastprefix ff02 ip6 allnodes ff02 ip6 allrouters hdfs datanode hdfs datanode hadoop network equivalent datanode shows hdfs datanode localhost localhost ip6 localhost ip6 loopback fe00 ip6 localnet ff00 ip6 mcastprefix ff02 ip6 allnodes ff02 ip6 allrouters hdfs namenode hdfs namenode hadoop network running confirms default dev eth0 dev eth0 proto kernel scope link src default dev eth0 dev eth0 proto kernel scope link src datanode starts namenode reports datanodes ip address info hdfs statechange block registerdatanode datanoderegistration datanodeuuid 3abaf40c 4ce6 47e7 be2b fbb4a7eba0e3 infoport infosecureport ipcport storageinfo lv cid cid 60401abd 4acf 94dc e8db02b27d59 nsid storage 3abaf40c 4ce6 47e7 be2b fbb4a7eba0e3 info blockmanagement datanodedescriptor number failed storage info net networktopology adding node default rack info blockmanagement datanodedescriptor number failed storage info blockmanagement datanodedescriptor adding storage id ds 4ba1a710 a4ca 4cad cc5f16c213fb dn info blockstatechange block processreport storage ds 4ba1a710 a4ca 4cad cc5f16c213fb node datanoderegistration datanodeuuid 3abaf40c 4ce6 47e7 be2b fbb4a7eba0e3 infoport infosecureport ipcport storageinfo lv cid cid 60401abd 4acf 94dc e8db02b27d59 nsid blocks hasstalestorage false processing time msecs capture traffic running docker container attached host network show error occurring network interface created docker ip address correctly call 0x0050 f828 004d 0a10 registerda 0x0060 6e6f 6f72 672e tanode 7org apac 0x0070 2e68 6f6f 702e 2e73 hadoop hdfs 0x0080 722e 6f74 6f63 6f6c 2e44 erver protocol 0x0090 616e 6f64 726f 746f 636f 6c18 atanodeprotocol 0x00a0 01a7 010a a401 0a51 0a0a 322e 0x00b0 2e30 2e33 120f 2d64 616e hdfs datan 0x00c0 6f64 652d 311a 632d ode 3abaf40c subsequent calls incorrect call fraction 0x0050 f828 004a 0a0d 6e64 sendheartb 0x0060 376f 2e61 652e eat 7org apache 0x0070 646f 6f70 2e68 732e hadoop hdfs serv 0x0080 2e70 726f 746f 636f 6c2e er protocol data 0x0090 6e6f 6f74 6f63 6f6c 9d02 nodeprotocol 0x00a0 0aa4 010a 510a 0a31 2e31 382e 302e 0x00b0 0f68 732d 6e6f hdfs datanode 0x00c0 2d31 1a24 2d34 3abaf40c 4ce debugging datanode code shows error occuring href https github apache hadoop blob release hadoop hdfs project hadoop hdfs src main org apache hadoop hdfs server datanode bpserviceactor l754 rel nofollow datanode registration details updated based information returned namenode debugging namenode href https github apache hadoop blob release hadoop hdfs project hadoop hdfs src main org apache hadoop hdfs server blockmanagement datanodemanager l852 rel nofollow shows reads strong incorrect strong ip address datanode socket connection updates datanode registration details strong additional notes strong reproduce issue code running user defined docker network running correctly outputs running incorrectly outputs running code user defined network default network interface exposing port correct output property set namenodes file prevent reverse dns lookup errors unnecessary future dns working wrong ip address reported datanodes doubt dns working relevant wire protocols href https github apache hadoop blob trunk hadoop hdfs project hadoop hdfs src main proto datanodeprotocol proto rel nofollow definitions found data member message href https github apache hadoop blob trunk hadoop hdfs project hadoop hdfs client src main proto hdfs proto rel nofollow defined 

caused href https github docker docker issues rel nofollow docker issue raised closed href https github docker docker issues rel nofollow duplicate describes steps set question href https github docker libnetwork pull rel nofollow merged pull request fix problem scheduled inclusion docker meantime workaround ol li remove user created networks li li stop docker daemon li li cleanup iptables li li restart docker daemon li li recreate user defined network li li run containers li ol 