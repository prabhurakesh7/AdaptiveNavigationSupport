flatten list c1 c1 collection c2 single element stream api 
structure simplified fill structure execute query pre class lang sql prettyprint override directly read jdbi line line structure data read similar flatten list make created piece code job achieve streams find group c2s instances belong c1 instance return collection flattened knowing elements visited retrieving add 

spirit dmitry ginzburg implemented differently collector create maps c1s id set similar id merge values sets set finally entry set map entry c1 instance collect instances list assumed constructor accepts set parameter 