filechannel copy transferto fails copy bytes socketchannel 
strange behavior transferring large files file socket copy environments ul li windows bit jdk li li centos bit jdk li ul program client copies input file socket server copies socket output file copy methods transferfrom transferto bytes reaching server file size large 100mb case windows 2gb case centos client server reside machine localhost address transfer data behavior depending os windows client completes transferto method successfully number transferred bytes equal input file size server hand reports lower number received bytes linux bytestransferred client 2gb input file size 4gb sufficient space configurations windows transfer 130mb file workarounds increasing receive buffer size server adding thread sleep method client leads transferto method client completes bytes socket send buffer server bytes make server guaranteed creates problems case linux maximum file size transfer single transferto invocation 2gb client reports correct number bytes server questions whats client ensure guaranteed delivery file server cross platform mechanisms emulate sendfile windows heres code client zerocopyclient server zerocopyserver strong update strong linux code fixed loop strong update strong workaround requires client server cooperation end transmission server writes length received data back client client reads blocking mode server responds client blocks read result client waits bytes pass send receive socket buffers fact waits bytes stored output file implement band acknowledgements client wait suggested section ii href https linuxnetworkstack files wordpress paper pdf rel nofollow https linuxnetworkstack files wordpress paper pdf case file content mutable blockquote wait amount time rewriting portion file blockquote strong update strong modified incorporating fixes ejp the8472 length file checksum verification output tracing computing crc32 checksum large file seconds complete client server 

solution check write counter filechannel transferfrom 