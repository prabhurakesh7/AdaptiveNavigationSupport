excel formatting apache poi 
excel file format img src http stack imgur eqa3o png alt input format restructure format outputted format img src http stack imgur i9dmn png alt output format sections repeating order format check column merged rows shown image achieve 

href https code google guava libraries wiki newcollectiontypesexplained table rel nofollow guavas table data structure save reinventing wheel caveats ul li mathematical trick matrices pivot tables functional programming job code li li latest greatest poi classes li li brute force data iterations easy follow li li assumed practical identify ranges cells define data abc xyz li li guessed row column merged area actual dont case li li code easily optimized final variables li ul result output sect check cat qqq abc qqq abc www abc www abc eee abc eee abc rrr abc qqq xyz qqq xyz www xyz www xyz www xyz www xyz eee xyz 