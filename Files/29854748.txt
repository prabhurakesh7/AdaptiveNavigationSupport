android connecting usb device wait permission 
connect usb device opened failed connection logic examples explanations found problem waiting permission grant good wait notifyall loop checks times waiting method waitconnection blocking timeout gave message received versions ol li wait notifyall li li loop li ol cases logs waitconnection method called consumer immediately startconnection block execution gave timeout seconds blocked seconds completed broadcastreceiver message appears requestpermission async thought case startconnection exits immediately message received wait broadcastreceiver message dont waitconnection method consumer moment start checking connection availability 

completed broadcastreceiver message callback default called main thread sounds calling main thread blocks main thread process additional messages returns means called times generally bad idea block main thread href http developer android guide components processes threads html threads rel nofollow read launch activity usb permission solution key block main thread 