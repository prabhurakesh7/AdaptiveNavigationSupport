hook process container asks roles ldap user 
application form based authentication ldap realm authorization database understand works hook process application calls background ldap database strong strong customize database query 

strong tl dr href https gist github anonymous ab768e6d51779001b125 file httpservletsam rel nofollow href https gist github anonymous ab768e6d51779001b125 file standaloneldapsam rel nofollow sample solution strong hr depends degree flexibility offered vendor specific feature product extend behaviour theyre called proprietary class es type sql query administrative uis input field bottom line standard functionality standard ee side spectrum em jaspic em user message authentication em jacc em authorization spis retrieve security related information pertaining users external store jaspic change users roles em em authentication duration em authenticated request em users roles em fixed em jaspic attach em meaning em roles theyre plain proprietary manner derive group jacc hand things establishes rulebase href http docs oracle javase docs api security policy html rel nofollow precisely associates roles principals href http docs oracle javase docs api security permission html rel nofollow queried user system interaction jacc override alter interpretation ee security constraints expressed deployment descriptors annotations include jaspic based solution post disregard jacc part ul li additional flexibility jacc offers li li employing custom jacc provider solution requires href http arjan tijms omnifaces org ee authorization jacc revisited html rel nofollow href http arjan tijms omnifaces org ee authorization jacc revisited html rel nofollow bit href http arjan tijms omnifaces org ee authorization jacc revisited html rel nofollow work standard due specific group role mapping li li unaware open source project custom jacc provider accomplishing meaningful ee full profile implementing ass sole exception mandated implement spec jacc providers internally case glassfish li li lot confusion surrounding jaspic developers unaware exists simplest specs imho reasonable make jaspic approachable people moving covering jacc li li mere great examples jaspic online projects implementing actual authentication jaspic providers correct mistaken havent found complete jaspic li ul remarks ul li warranty risk dont sue app system explodes hacked alien li li disregard spots optimization design improvements opinion essential admittedly reuse db ldap connections validate usernames inserted ldap search filters care thread safety tls return formed xml payloads addressing concerns scope provided solution excuse em unit tests em heard term li li sams concretely performing authentication retrieval groups roles provided standalone accomplishes tasks delegating suggests demonstrates sam delegate actual authentication work jaas href https docs oracle javase docs api javax security auth spi loginmodule html rel nofollow lm employing jaspic em loginmodule bridge profile em sam requires configuration adaptation source level se glassfish accompanying jaas entry provided li li provider classes tested glassfish strive remain spec compliant work sam provided product implements full ee preferably profile doesnt wont test li li avoid studying href https docs oracle javaee api javax security auth message config authconfigprovider html rel nofollow href https docs oracle javaee api javax security auth message config serverauthconfig html rel nofollow implementations register actual sam products href https docs oracle javaee api javax security auth message config authconfigfactory html rel nofollow proprietary vendor specific deployment administrative tools additionally sam implementing href https docs oracle javaee api javax security auth message config serverauthcontext html rel nofollow interface load accompanying sam instantiate missing classes possibly reusing global pre configured applications message layers depending reuses instantiated requests case lifecycle sam affected li li group role mapping covered container specific li li included comments felt completely useless aided spec code comprehensible feel free somethings troubling apologies overlength post li li paths absolute root standard maven project youve adapted properties authentication group retrieval methods sams build files war deploy test sole dependency jdbc driver present class path li li move code href https gist github anonymous ab768e6d51779001b125 rel nofollow gist due sos post length constraint li ul hr ol li href https gist github anonymous ab768e6d51779001b125 file bigjaspicfactoryregistrar rel nofollow registering save li li href https gist github anonymous ab768e6d51779001b125 file bigjaspicfactory rel nofollow save li li href https gist github anonymous ab768e6d51779001b125 file littlejaspicserverfactory rel nofollow save li li base dual href https gist github anonymous ab768e6d51779001b125 file httpservletsam rel nofollow implementation helper class part actual answer save li li href https gist github anonymous ab768e6d51779001b125 file standaloneldapsam rel nofollow standalone sam implementation actual answer part save li li href https gist github anonymous ab768e6d51779001b125 file jaasdelegatingldapsam rel nofollow jaas lm delegating sam actual answer part save li li convenience href https gist github anonymous ab768e6d51779001b125 file jaspicmischief rel nofollow exception type save li li accompanying href https gist github anonymous ab768e6d51779001b125 file jaspic provider properties rel nofollow adapt youd test actual authentication code verbatim save li li accompanying href https gist github anonymous ab768e6d51779001b125 file sample login conf rel nofollow sample snippet consult vendors documentation actual file system location li li optional demonstration purposes href https gist github anonymous ab768e6d51779001b125 file userutils rel nofollow jsf backing bean li li optional demonstration purposes href https gist github anonymous ab768e6d51779001b125 file index xhtml rel nofollow unprotected index page li li optional demonstration purposes href https gist github anonymous ab768e6d51779001b125 file login xhtml rel nofollow login page li li optional demonstration purposes href https gist github anonymous ab768e6d51779001b125 file info xhtml rel nofollow protected index page users role li li optional demonstration purposes sake completness href https gist github anonymous ab768e6d51779001b125 file web xml rel nofollow web module dd li ol hr reading ol li href https www jcp org en jsr detail id rel nofollow jsr jaspic specification li li href http stackoverflow users arjan tijms arjan tijmss href https jaspic zeef arjan tijms rel nofollow jaspic zeef page li li href https www jcp org en jsr detail id rel nofollow jsr jacc specification li ol hr jaspic generic spi theory authenticate jms saml soap kind message plugged capable message processing runtime predominantly em servlet container profile em overly constrain jaspics low level flexible nature entails unawareness protocol specific functionality http session sams triggered runtime perform authentication request spec makes provision potential shortcoming allowing sams request initiation em container authentication session em runtime em callback property em asked authenticate subsequent requests client sams avoid repeating entire process runtime reuse previously established authentication session user identity caller group accomplished execution leave authentication state protocol shown sample code lastly noted jaspic servlet spec defines em container authentication session em sam authenticated user practical purposes authentication session equivalent http session long authentication pertains single application context sam explained signals reuse authentication session request 