security invalidkeyexception wrong key size decryption 
decryption mix em wrong key size em em final block properly padded em dependent os running win7 ibmjce sunjce java8 decryption fails time blockquote javax crypto badpaddingexception final block properly padded sun crypto provider ciphercore dofinal ciphercore sun crypto provider ciphercore dofinal ciphercore sun crypto provider desedecipher enginedofinal desedecipher javax crypto cipher dofinal cipher blockquote mac sunjce decryption fails time blockquote security invalidkeyexception wrong key size sun crypto provider desedecrypt init desedecrypt sun crypto provider cipherblockchaining init cipherblockchaining sun crypto provider ciphercore init ciphercore sun crypto provider desedecipher engineinit desedecipher javax crypto cipher implinit cipher javax crypto cipher chooseprovider cipher javax crypto cipher init cipher blockquote desede key size windows decryption bytes mac bytes heres starting point exception throw decryptwithsymmetrickey short cycled code specific desede couldnt narrow security space encrypt symmetric key key length environments encrypt string symmetric key decrypting decoding symmetric key variable length key mac failures happen windows fails cipher dofinal time mac fails cipher init time assume solve mac solve windows 

problem lines method generated des key randomly characters printable calling youre silently dropping unprintable characters breaks key hr h3 considerations h3 key size correct generate bits em em expects key size including parity bits security level bits security level bit desede bit key bit counting parity bits shouldnt desede aes security dont static iv bytes strong randomness source generate iv encryption doesnt secret simply prepend ciphertext forget slice decryption youre authenticating symmetric ciphertexts encrypt mac approach strong mac hmac sha256 authenticated mode operation gcm eax 