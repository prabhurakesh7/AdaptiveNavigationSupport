accumulating streams 
recently reimplement data parser streams figure specific thing object timestamp object made objects metrics tells time range object method state list objects fits object creates instance starts putting objects streams list objects make stream figure function create chunks accumulate objects br edit complex post simplified version simplified dont ugly 

general problem badly suitable stream api local knowledge makes parallel processing harder imagine set basically combine input batches elements problem discussed href http stackoverflow answer split task subtasks suffix part elements prefix part start combining data batches prefix processed problem essentially serial hand solution provided href http amaembo github io streamex javadoc util streamex streamex html headtail util function bifunction util function supplier rel nofollow method href https github amaembo streamex rel nofollow streamex library method parallelizes badly define operation lines heres solve problem modified method sample assuming output wrote simple lazy hr strong explanation strong parameters lambdas called input stream empty receives stream element head stream elements tail called input stream empty receives parameters produce output stream starting case create call add existing call create prepend output stream current emitting element target stream input stream exhausted return gathered implementation guarantees solution recursive eat stack heap constant amount check thousands input elements doubt 