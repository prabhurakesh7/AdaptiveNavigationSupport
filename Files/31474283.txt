aes file decrypting final block properly padded 
encrypt decrypt file aes read topics error dont find solution language code dont write language code strong variables strong strong createsecretkey strong strong method encrypt strong strong method decrypt strong strong update strong solution edit size multiples cipherinput output read write file tks 

aes block cipher works blocks bytes mode operation cbc enables chain multiple blocks padding pkcs padding enables encrypt arbitrary length plaintext filling plaintext multiple block size problem youre encrypting bytes separately divides block size padding adds strong full strong block encryption ciphertext chunks bytes long decryption youre reading missing padding decrypt remove padding padding malformed exception thrown h2 easy fix h2 simply increase buffer decryption bytes h2 proper fix h2 dont encrypt separate chunks href http docs oracle javase docs api javax crypto cipher html update 28byte 20int 20int rel nofollow update ciphertext buffer read href http docs oracle javase docs api javax crypto cipherinputstream html rel nofollow hr security considerations youre missing random iv attacker encrypted plaintext key observing ciphertexts youre missing ciphertext authentication reliably detect malicious ciphertexts open system attacks padding oracle attack authenticated mode gcm run created ciphertext hmac create authentication tag write end verify tag decryption 