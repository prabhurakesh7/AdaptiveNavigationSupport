incorporate database connection aspectj 
put database connection close methods aspectj class add method createconnection closeconnection methods aspect class dont belong scope addbookdetails advice dont understand conn object move method needed createstatement method class 

strong entity classes strong classes op methods expect aspect intercept methods executed magically create execute sql statements pre class lang prettyprint override pre class lang prettyprint override assume derive sql table class appending plural important aspect sql magic strong db connection mock class strong class special returning objects expected application posting sake making compileable runnable pre class lang prettyprint override strong driver application strong pre class lang prettyprint override strong aspect strong aspect helper methods taking care ul li creating sql statement text li li opening db connection executing sql statement closing connection li ul pre class lang prettyprint override strong console output strong pre class lang prettyprint override feel free follow questions understand sample code 