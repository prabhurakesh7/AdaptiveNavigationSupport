failing integration test apache spark streaming 
track issue unit integration tests writing apache spark project spark test passed upgrade test starts failing managed reduce code needed reproduce issue small integration test interestingly comment runwith annotation test test passes correctly dont runwith annotation cut test real tests make mocks fairly extensively id drop powermock pre class lang prettyprint override exception versions dependencies shown ul li hadoop client li li apache spark li li junit li li easy mock li li power mock li ul versions spark test passes versions spark ul li li li li ul starts failing spark onwards ideas change work 

source code sparkcontext line causing exception current user href https github apache spark blob branch core src main scala org apache spark sparkcontext scala l321 version fallback default required currectly logged user code introduced href https github apache spark blob branch core src main scala org apache spark sparkcontext scala l301 version default user anymore dont error earlier versions calls href https github apache spark blob master core src main scala org apache spark util utils scala l2203 code set environment variable prevent branching usergroupinformation leads exception hadoop security class preventing working properly 