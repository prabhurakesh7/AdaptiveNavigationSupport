class loading issue running hadoop job 
service exposes interfaces submit submitting distcp job yarnrm query querying status application service internally calls client jni static functions ol li submit li li query li ol submit query problem facing ol li call service submit subsequent calls submit query succeed li li call service query submit calls fail li ol query calls succeed conditions submit calls fail errors 1st call 2nd call 3rd call exceptions ol li li li li li li ol debugged issue figured query api called classes loaded class loader load classes submit called happening observed query api called hadoop configuration changed lot default settings related mapreduce configuration explicit loading class forname submit method called submit called class loader load required classes problem hadoop configuration class loader problem mixing mapreduce yarn apis mapreduce framework configuration set yarn environment hadoop classpath hadoop jars present paths 

figured mixing apis causing class loading problems called loads yarn related classes mapreduce related classes loaded class loaded called class loader assumes loaded required classes classes loaded call fails force class loader load related classes added statements constructor singleton class wraps resolved issue cleaner implementation client ensure class loading issues 